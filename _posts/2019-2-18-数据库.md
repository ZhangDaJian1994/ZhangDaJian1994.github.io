## 数据生命周期

![1550474766313](C:\Users\15941\AppData\Roaming\Typora\typora-user-images\1550474766313.png)

### 联机事务处理（OLTP）

&emsp;&emsp;数据首先进入OLTP 系統。OLTP 的重点是数据输入，而不是生成报表，主要处理的事务包括插入、更新和删除数据。
&emsp;&emsp;OLTP 环境不适合生成报表的使用目的。

### 数据仓库（DW）

&emsp;&emsp;数据仓库（DW）是专门针对数据检索和生成报表而设计的环境，数据仓库的模型有意保持了一定的冗余，允许通过更少的表和更简单的关系，最终得到比OLTP 更简单和有效的查询

### ETL （Extract Transform and Load）

&emsp;&emsp;从源系统（OLTP 及其他系統）抽取数据，对数据进行处理，并将数据加载到数据仓库的工具称为ETL。

### 联机分析处理（OLAP）
&emsp;&emsp;支持对聚合后的数据进行动态在线分析

### Select 语句的元素
1. FROM
2. WHERE
3. GROUP BY
4. HAVING
5. SELECT
6. ORDER BY

SQL 执行顺序

（8）SELECT（9）DISTINCT 
（1）FROM 
（3） JOIN 
（2）ON 
（4）WHERE 
（5）GROUP BY 
（6）WITH {CUTE|ROLLUP} 
（7）HAVING 
（10）ORDER BY 
（11）LIMIT



#### 数据库的事务有什么用
一个操作序列，要么都执行，要么都不执行，保证数据一致性。

#### 事务4大属性
1. 原子性
2. 一致性
3. 隔离性
4. 持久性

#### 为什么要设置隔离级别
避免 更新丢失、脏读、不可重复读、幻想读

#### 悲观锁和乐观锁
悲观锁，指对数据被外界修改持保守态度，在整个数据处理过程中，将数据处于锁定状态，往往依靠数据库提供的锁机制，行锁和表锁

乐观锁，认为数据一般情况下不会造成冲突，所以只在数据进行提交更新的时候，才会正式对数据的冲突与否进行检测
1. 使用版本号

为数据库表增加一个数字类型的“version” 字段实现。当读取数据时，将version 字段的值一同读出，数据每更新一次，对此version 值加1。当我们提交更新时候，如果数据库当前版本号与第一次取出来的version 值想等，则予以更新，否则是过期数据。
2. 使用时间戳

和第一种方式差不多，version 换成了 时间戳

#### 分库分表
分表：利用id 字段进行hash 分表
分库：利用id 字段进行hash 分库